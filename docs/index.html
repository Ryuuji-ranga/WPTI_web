<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WPTI 診断フォーム</title>
    <style>
        body {
            font-family: "Hiragino Sans", sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #fafafa;
            line-height: 1.7;
        }

        h1 {
            text-align: center;
        }

        .question-box {
            background: #fff;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        button {
            display: block;
            margin: 30px auto;
            padding: 10px 25px;
            font-size: 18px;
            border: none;
            background: #0078ff;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        #result {
            display: none;
            background: #e8f4ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
    </style>
</head>
<body>

    <h1>WPTI 16タイプ診断</h1>

    <label>性別</label>
    <select name="gender" required>
        <option value="">選択してください</option>
        <option value="男性">男性</option>
        <option value="女性">女性</option>
        <option value="その他">その他</option>
    </select>

    <label>年代</label>
    <select name="age" required>
        <option value="">選択してください</option>
        <option value="10">10代</option>
        <option value="20">20代</option>
        <option value="30">30代</option>
        <option value="40">40代</option>
        <option value="50">50代</option>
        <option value="100">60代以上</option>
    </select>

    <p>各質問に対し、もっとも近い選択肢を選んでください。（1〜5の5段階）</p>

    <form id="wptiForm">
        <div id="questionContainer"></div>
        <button type="button" onclick="calculateWPTI()">診断する</button>
    </form>

    <div id="result"></div>

    <script>
        // ==========================
        //  質問データ
        // ==========================
        const questions = [
            { q: "新しい人や新しい仕事に触れるとエネルギーが湧く？", axis: "DS", reverse: false },
            { q: "複数の領域を行き来しながら働きたい？", axis: "DS", reverse: false },
            { q: "同時に複数の仕事を進めるのが得意？", axis: "DS", reverse: false },
            { q: "一つのことを深掘りして極めるほうが心地よい？", axis: "DS", reverse: true },
            { q: "まず『実行可能性』を最初に考える？", axis: "AC", reverse: false },
            { q: "データよりアイデア・未来の可能性を優先する？", axis: "AC", reverse: true },
            { q: "計画を立てる際、具体的な手順から考え始める？", axis: "AC", reverse: false },
            { q: "新しいアイデアを生み出すときワクワクする？", axis: "AC", reverse: true },
            { q: "とりあえず動いてみてから考えるタイプ？", axis: "RM", reverse: false },
            { q: "締切間際になると一気に集中して動く？", axis: "RM", reverse: false },
            { q: "完成度よりスピードを優先しがち？", axis: "RM", reverse: false },
            { q: "不確実な状況でも動きながら調整できる？", axis: "RM", reverse: false },
            { q: "一人で作業する時間に価値を感じる？", axis: "TP", reverse: false },
            { q: "人と話すことでアイデアが広がる？", axis: "TP", reverse: true },
            { q: "単独で責任を持って動く方がやりやすい？", axis: "TP", reverse: false },
            { q: "チームの雰囲気を重視して仕事をしたい？", axis: "TP", reverse: true }
        ];

        // ==========================
        //  タイプ説明データ
        // ==========================
        const typeDescriptions = {
            "DART": "戦略指揮官：戦略的で行動力があり、技術理解も強いリーダータイプ。",
            "DARP": "柔軟な助言者：人と分析の両面に強く、提案・営業力が高い。",
            "DACT": "精密設計者：構造化・設計・発明に強いクリエイティブ技術者。",
            "DACP": "理想の先導者：アイデア生成＆人を巻き込む未来創造型。",
            "DMRT": "熟練技術者：慎重×技術で高品質アウトプットを出す技術者。",
            "DMRP": "安定の管理者：現場を安定してまとめる管理・調整の達人。",
            "DCRT": "迅速な創造者：高速で創造し技術を用いて形にする革新タイプ。",
            "DCRP": "推進力のある創作者：人を巻き込みアイデアを実現する推進型クリエイター。",
            "SART": "戦術の達人：裏方として技術でチームを支える戦術型エンジニア。",
            "SARP": "洞察に優れた伝達者：相手を理解して論理的に提案できる営業タイプ。",
            "SAMT": "系統の守り手：安全・正確・堅実なシステム運用の守護者。",
            "SAMP": "信頼の分析者：数字とデータに強く、分析の精度が高い。",
            "SCRT": "速やかな発明者：高速でクリエイティブ成果物を生み出すタイプ。",
            "SCRP": "共感する企画者：共感しながら企画を作るプランナー。",
            "SCMT": "技術に精通した職人：職人型のクリエイティブ技術者。",
            "SCMP": "調和を生む設計者：丁寧で調和のとれたデザインが得意なタイプ。"
        };

        // ==========================
        //  質問の表示
        // ==========================
        function loadQuestions() {
            const container = document.getElementById("questionContainer");
            questions.forEach((item, i) => {
                const box = document.createElement("div");
                box.className = "question-box";
                box.innerHTML = `
                    <p><b>Q${i + 1}. ${item.q}</b></p>
                    <label><input type="radio" name="q${i}" value="1">1：当てはまる</label><br>
                    <label><input type="radio" name="q${i}" value="2">2：やや当てはまる</label><br>
                    <label><input type="radio" name="q${i}" value="3">3：どちらともいえない</label><br>
                    <label><input type="radio" name="q${i}" value="4">4：やや当てはまらない</label><br>
                    <label><input type="radio" name="q${i}" value="5">5：当てはまらない</label><br>
                `;
                container.appendChild(box);
            });
        }
        loadQuestions();

        // ==========================
        //  診断結果計算
        // ==========================
        function calculateWPTI() {
            let scores = { D: 0, S: 0, A: 0, C: 0, R: 0, M: 0, T: 0, P: 0 };

            for (let i = 0; i < questions.length; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (!answer) { alert(`Q${i + 1}に回答していません`); return; }

                let value = Number(answer.value);
                if (questions[i].reverse) value = 6 - value;

                const left = value;
                const right = 6 - value;

                if (questions[i].axis === "DS") { scores.D += left; scores.S += right; }
                if (questions[i].axis === "AC") { scores.A += left; scores.C += right; }
                if (questions[i].axis === "RM") { scores.R += left; scores.M += right; }
                if (questions[i].axis === "TP") { scores.T += left; scores.P += right; }
            }

            const type =
                (scores.D >= scores.S ? "D" : "S") +
                (scores.A >= scores.C ? "A" : "C") +
                (scores.R >= scores.M ? "R" : "M") +
                (scores.T >= scores.P ? "T" : "P");

            document.getElementById("result").style.display = "block";
            document.getElementById("result").innerHTML = `
                <h2>あなたのWPTIタイプ：<b>${type}</b></h2>
                <p>${typeDescriptions[type]}</p>
            `;

            const gender = document.querySelector('select[name="gender"]').value;
            const age = document.querySelector('select[name="age"]').value;

            fetch("/api/wpti", {
                method: "POST",
                headers: { "Content-Type": application / json },
                body: JSON.stringify({ gender, age, type, scores })
            });
        }
    </script>

</body>
</html>